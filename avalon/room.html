<!DOCTYPE html>

{% autoescape true %}
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
    $(document).ready(function(){
    	function queryRoomReady(){
    		var room_name = $('#room_name').attr('room_name');
    		$.get('/ready/' + room_name, function(data, status) {
    			json_data = $.parseJSON(data);
    			if (json_data['number_of_users']) {
					$('#number_of_users').text('Number of Users is: ' + json_data['number_of_users'])
				}
    			if (json_data['ready']) {
    				$('#status_label').text('Room Ready');
    				if (json_data['role']) {
    					$('#identity').text('Your Identity is: ' + json_data['role'])
    				}
    			} else {
    				setTimeout(queryRoomReady, 1000);
    			}
    		});
    	}
    	queryRoomReady();
    });
    </script>
  </head>
  <body>
    <div id="room_name" room_name={{ room_name }}> </div>
    <h1 id="status_label">Room Not Ready</h1>
    <h1 id="number_of_users"></h1>
    <h1 id="identity">Identity Unknown</h1>
  </body>
</html> 
{% endautoescape %}